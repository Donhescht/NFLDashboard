getwd()
read.table("Salary2.txt",header = FALSE,sep = "\t")
Salary = read.table("Salary2.txt",header = FALSE,sep = "\t")
str(Salary)
Salary$V4
?gsub
gsub("\,","",Salary$V4)
gsub(",","",Salary$V4)
gsub("$|,","",Salary$V4)
gsub("^$|,","",Salary$V4)
gsub("^$","",Salary$V4)
gsub("\$","",Salary$V4)
gsub("\$","",Salary$V4)
gsub("\\$","",Salary$V4)
gsub("\\$","",Salary$V4)
gsub("\,","",gsub("\\$","",Salary$V4))
gsub(",","",gsub("\\$","",Salary$V4))
gsub(",","",gsub("\\$","",Salary[,4]))
gsub(",","",gsub("\\$","",Salary[,4-7]))
install.packages("dplyr")
install.packages("RPostgreSQL")
install.packages("DBI")
salary[,4-7] <- gsub(",","",gsub("\\$","",Salary[,4-7]))
Salary[,4-7] <- gsub(",","",gsub("\\$","",Salary[,4-7]))
str(Salary)
Salary[,4-7] <- is.number(gsub(",","",gsub("\\$","",Salary[,4-7])))
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
str(salary)
salary[,4-7] <- as.numberic(gsub(",","",gsub("\\$","",salary[,4-7])))
salary[,4-7] <- as.integer(gsub(",","",gsub("\\$","",salary[,4-7])))
salary$V4
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
as.integer(gsub(",","",gsub("\\$","",salary[,4-7])))
as.numeric(gsub(",","",gsub("\\$","",salary[,4-7])))
gsub(",","",gsub("\\$","",salary[,4-7]))
gsub(",","",gsub("\\$","",salary[,$V4]))
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
gsub(",","",gsub("\\$","",salary[,$V4]))
gsub(",","",gsub("\\$","",salary$V4))
typeof(gsub(",","",gsub("\\$","",salary$V4))_
typeof(gsub(",","",gsub("\\$","",salary$V4)))
as.integer(gsub(",","",gsub("\\$","",salary$V4)))
typeof(as.integer(gsub(",","",gsub("\\$","",salary$V4))))
str(salary)
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
str(salary)
install.packages("lattice")
install.packages("ggplot2")
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
library("lattice")
library("ggplot2")
str(salary)
with(salary, qplot(V1,V6))
summary(salary)
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
summary(salary)
with(salary, qplot(V1,V6))
qplot(salary$V1,salary$V6,geom_smooth)
qplot(salary$V1,salary$V6,geom_smooth())
qplot(salary$V1,salary$V6) + geom_smooth()
str(salary)
qplot(salary$V1,salary$V6,facets=salary$V3) + geom_smooth()
?ggplot2
?ggplot
summary(salary)
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
str(salary)
colnames(salary) <- c("year","team","offense_cost", "defense_cost","total_cost")
str(salary)
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
salary$V2 <- NULL
str(salary)
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
salary
salary <- read.table("Salary2.txt", header = FALSE, sep = "\t")
salary <- salary[,-c(V2)]
salary
str(salary)
salary <- salary[,-c("V2")]
salary <- salary[,!(names(salary) %in% c("V2"))]
str(salary)
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
salary <- read.table("Salary2.txt", header = FALSE, sep = "\t") salary <- salary[,!(names(salary) %in% c("V2"))]
str(salary)
colnames(salary) <- c("year","team","offense_cost", "defense_cost","total_cost")
str(salary)
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
str(salary)
library(RPostgreSQL)
library()
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
team <- dbReadTable(con, c("public", "team"))
str(team)
teamyearstats <- dbReadTable(con, c("public", "teamyearstats"))
str(teamyearstats)
merge(teamyearstats,team, by.x = "team_id", by.y = "team_id")
m <-merge(teamyearstats,team, by.x = "team_id", by.y = "team_id")
str(m)
str(salary)
m <-merge(teamyearstats,team, by.x = "team_id", by.y = "team_id")
paste(m$city,m$name,sep = " ")
salary$names
salary$team
mutate(m, fullname = paste(m$city, m$name, sep = " "))
merge(m,teamyearstats, by.x = "fullname", by.y = "name")
str(teamyearstats)
str(m)
str(salary)
str(m)
m[, !(names(salary) %in% c("offense_cost","defense_cost","total_cost"))]
str(m[, !(names(salary) %in% c("offense_cost","defense_cost","total_cost"))])
str(m[, !(names(m) %in% c("offense_cost","defense_cost","total_cost"))])
m <- m[, !(names(m) %in% c("offense_cost","defense_cost","total_cost"))]
str(m)
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
str(team_merged)
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
str(teamyearstats)
merge(teamyearstats,salary, by.x = "fullname", by.y = "name")
str(salary)
merge(teamyearstats,salary, by.x = "fullname", by.y = "team")
str(teamyearstats)
summary(teamyearstats)
str(teamyearstats)
str(salary)
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
str(salary)
str(teamyearstats)
merge(teamyearstats,salary, all=TRUE)
merge(teamyearstats,salary, all=FALSE)
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
teamyearstats
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
library(dplyr) library(RPostgreSQL) library(DBI)
# Get salary from text file and improve table for update of db salary <- read.table("Salary2.txt", header = FALSE, sep = "\t") salary <- salary[,!(names(salary) %in% c("V2"))] colnames(salary) <- c("season_year","fullname","offense_cost", "defense_cost","total_cost") salary$offense_cost <- as.integer(gsub(",", "", gsub("\\$", "", salary$offense_cost))) salary$defense_cost <- as.integer(gsub(",", "", gsub("\\$", "", salary$defense_cost))) salary$total_cost <- as.integer(gsub(",", "", gsub("\\$", "", salary$total_cost)))
drv <- dbDriver("PostgreSQL") con <- dbConnect(drv, dbname="nfldb",port="5432", host="localhost", user="postgres",password="Canon7D")
team <- dbReadTable(con, c("public", "team")) teamyearstats <- dbReadTable(con, c("public", "teamyearstats"))
teamyearstats <- merge(teamyearstats, team, by.x = "team_id", by.y = "team_id")
x <- with(teamyearstats, paste(city, name, sep = " ") x <- with(teamyearstats, paste(city, name, sep = " "))
x <- paste(teamyearstats$city, teamyearstats$name, sep = " "))
x <- paste(teamyearstats$city, teamyearstats$name, sep = " ")
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
str(teamyearstats)
xyplot(teamyearstats$season_year,teamyearstats)
library(lattice)
library(ggplot2)
xyplot(teamyearstats$season_year,teamyearstats)
boxplot(teamyearstats$cost)
boxplot(teamyearstats$cost ~ teamyearstats$season_year)
boxplot(teamyearstats$total_cost ~ teamyearstats$season_year)
plot(teamyearstats$total_cost ~ teamyearstats$season_year)
teamyearstats
ggplot(data=teamyearstats, aes(x=total_cost, y=wins)) + geom_point() + labs(title="Wins Versus Cost", x="Cost", y="Wins")
ggplot(data=teamyearstats, aes(x=wins, y=total_cost)) + geom_point() + labs(title="Wins Versus Cost", x="wins", y="Cost")
ggplot(data=teamyearstats, aes(x=wins, y=total_cost)) + geom_point() + labs(title="Wins Versus Cost", x="wins", y="Cost")
library(dplyr)
teamyearstats
data
data()
teamyearstats
install.packages("foreach")
install.packages("doMC")
foreach
install.packages("doSNOW")
registerDoSNOW() foreach(i = 1:length(teamyearstats$offense_cost), .inorder = FALSE, .packages = "RPostgreSQL") %dopar% {     update(i) }
library(dplyr) library(RPostgreSQL) library(DBI) library(foreach) library(doSNOW)
registerDoSNOW() foreach(i = 1:length(teamyearstats$offense_cost), .inorder = FALSE, .packages = "RPostgreSQL") %dopar% {     update(i) }
length(teamyearstats$offense_cost)
teamyearstats
registerDoSNOW() foreach(i = 1:length(teamyearstats$offense_cost), .inorder = FALSE, .packages = "RPostgreSQL") %dopar% {     update(i) }
source("UpdateTeamStat.R")
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/WinningVersusSpending.R", encoding = "Windows-1252")
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/WinningVersusSpending.R", encoding = "Windows-1252")
teamyearstats
str(teamyearstats)
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/WinningVersusSpending.R", encoding = "Windows-1252")
filter(ts,total_costs > 0)
?filter
dplyr.filter()
library(dplyr)
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/WinningVersusSpending.R", encoding = "Windows-1252")
filter(tys,total_cost>0)
tys<-filter(tys,total_cost>0)
tys[,tys$team_id=="CLE"]
tys[,team_id=="CLE"]
tys[team_id=="CLE",]
tys[tys$team_id=="CLE",]
cle=tys[tys$team_id=="CLE",]
xyplot(cle$total_cost ~ cle$season_year)
library(lattice)
xyplot(cle$total_cost ~ cle$season_year)
mean(cle$total_cost)
mean(tys$total_cost)
library(ggplot2)
aggregate(tys$total_cost,tys$season_year)
aggregate(tys$total_cost,tys$season_year,mean)
aggregate(tys$total_cost,list(Year = tys$season_year),mean)
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/WinningVersusSpending.R", encoding = "Windows-1252")
ggpolt2(data=tys, aes(x=wins,y=total_cost)) + geom_point() + labs(title="Winning and Total Cost (AAV)", x="Wins", y="Total Cost")
ggpolt(data=tys, aes(x=wins,y=total_cost)) + geom_point() + labs(title="Winning and Total Cost (AAV)", x="Wins", y="Total Cost")
ggplot(data=tys, aes(x=wins,y=total_cost)) + geom_point() + labs(title="Winning and Total Cost (AAV)", x="Wins", y="Total Cost")
ggplot(data = tys, aes(x = wins, y = total_cost)) +  geom_point() + geom_smooth(method="lm", color="red", linetype=2) + labs(title = "Winning and Total Cost (AAV)", x = "Wins", y = "Total Cost")
aggregate(tys$total_cost,list(Year = tys$season_year),mean)
cle=tys[tys$team_id=="CLE",]ggplot(data = tys, aes(x = wins, y = total_cost)) +  geom_density() + geom_smooth(method="lm", color="red", linetype=2) + labs(title = "Winning and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot(data = tys, aes(x = wins, y = total_cost)) +  geom_density() + geom_smooth(method="lm", color="red", linetype=2) + labs(title = "Winning and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot(data = tys, aes(x = wins)) +  geom_density() + geom_smooth(method="lm", color="red", linetype=2) + labs(title = "Winning and Total Cost (AAV)", x = "Wins", y = "Total Cost")
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/WinningVersusSpending.R", encoding = "Windows-1252")
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/WinningVersusSpending.R", encoding = "Windows-1252")
ggplot(data = tys, aes(x = wins, y = total_cost)) +  geom_point() + geom_smooth(method="lm", color="red", linetype=2) + labs(title = "Winning and Total Cost (AAV)", x = "Wins", y = "Total Cost")
aggregate(tys$total_cost, list(Year = tys$season_year), sum)
aggregate(tys$total_cost, sum)
aggregate(tys$total_cost, list(Year = tys$season_year), sum)
aggregate(tys$total_cost, list(team = tys$team_id), sum)
agcost <- aggregate(tys$total_cost, list(team = tys$team_id), sum)
agwin <- aggregate(tys$wins, list(team = tys$team_id), sum)
agwin
merge(agcost,agwin)
merge(agcost,agwin, by="team_id")
merge(agcost,agwin, by="team")
ag=merge(agcost,agwin, by="team")
tys
tys <- dbReadTable(con, c("public", "teamyearstats"))
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
teamyearstats
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/Salary.R", encoding = "Windows-1252")
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/WinningVersusSpending.R", encoding = "Windows-1252")
ggplot(data = tys, aes(x = wins, y = total_cost)) + geom_point() + geom_smooth(method = "lm", color = "red", linetype = 2) + labs(title = "Winning and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot(data = tys, aes(x = wins, y = total_cost)) + geom_boxplot() + geom_smooth(method = "lm", color = "red", linetype = 2) + labs(title = "Winning and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot(data = tys, aes(x = wins, y = total_cost)) + geom_histogram()  labs(title = "Winning and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot(data = tys, aes(x = total_cost, y = wins)) + geom_line() labs(title = "Winning and Total Cost (AAV)", x = "Wins", y = "Total Cost")
tysmean
ggplot(data = tysmean, aes(x = year, y = x)) + geom_point() + geom_smooth(method = "lm", color = "red", linetype = 2) + labs(title = "MeanTotal Cost (AAV)", x = "Year", y = "Mean Total Cost")
ggplot(data = tysmean, aes(x = Year, y = x)) + geom_point() + geom_smooth(method = "lm", color = "red", linetype = 2) + labs(title = "MeanTotal Cost (AAV)", x = "Year", y = "Mean Total Cost")
ggplot(data = tys, aes(x = Year, y = Wins, size=total_cost)) + geom_point() + geom_smooth(method = "lm", color = "red", linetype = 2) + labs(title = "Cost and Wins Per Year", x = "Year", y = "Wins", size = "Total Cost")
ggplot(data = tys, aes(x = season_year, y = Wins, size=total_cost)) + geom_point() + geom_smooth(method = "lm", color = "red", linetype = 2) + labs(title = "Cost and Wins Per Year", x = "Year", y = "Wins", size = "Total Cost")
ggplot(data = tys, aes(x = season_year, y = wins, size=total_cost)) + geom_point() + geom_smooth(method = "lm", color = "red", linetype = 2) + labs(title = "Cost and Wins Per Year", x = "Year", y = "Wins", size = "Total Cost")
ggplot(data = tys, aes(x = season_year, y = total_cost, size = wins )) + geom_point() + labs(title = "Cost and Wins Per Year", x = "Year", y = "Total Cost", size = "Wins")
ggplot(data = tys, aes(x = season_year, y = total_cost, color = wins)) + scale_color_manual(values=c("red", "yellow", "green")) + geom_point() + labs(title = "Cost and Wins Per Year", x = "Year", y = "Total Cost", color = "Wins")
ggplot(data = tys, aes(x = season_year, y = total_cost, color = wins)) + scale_color_brewer(palette="Set1") + geom_point() + labs(title = "Cost and Wins Per Year", x = "Year", y = "Total Cost", color = "Wins")
scale_ggplot(data = tys, aes(x = season_year, y = total_cost, color = wins)) + scale_colour_gradient(low = muted("red"), mid = "white",   high = muted("blue"), midpoint = 0, space = "Lab",   na.value = "grey50", guide = "colourbar") + geom_point() + labs(title = "Cost and Wins Per Year", x = "Year", y = "Total Cost", color = "Wins")
ggplot(data = tys, aes(x = season_year, y = total_cost, color = wins)) + scale_colour_gradient(low = muted("red"), mid = "white",   high = muted("blue"), midpoint = 0, space = "Lab",   na.value = "grey50", guide = "colourbar") + geom_point() + labs(title = "Cost and Wins Per Year", x = "Year", y = "Total Cost", color = "Wins")
ggplot(data = tys, aes(x = season_year, y = total_cost, color = wins)) + scale_colour_gradient(low = muted("red"), high = muted("green")) + geom_point() + labs(title = "Cost and Wins Per Year", x = "Year", y = "Total Cost", color = "Wins")
ggplot(data = tys, aes(x = season_year, y = total_cost, color = wins)) + scale_colour_gradient(low = "red", high = "green") + geom_point() + labs(title = "Cost and Wins Per Year", x = "Year", y = "Total Cost", color = "Wins")
ggplot(data = tys, aes(x = season_year, y = total_cost, color = wins)) + scale_colour_gradient(low = "red", high = "green") + geom_point() + geom_smooth(method = "lm", color = "red", linetype = 2) + labs(title = "Cost and Wins Per Year", x = "Year", y = "Total Cost", color = "Wins")
ggplot(data = tys, aes(x = season_year, y = total_cost, color = wins)) + scale_colour_gradient(low = "red", high = "green") + geom_point() + geom_smooth(method = "lm", color = "green", linetype = 2) + labs(title = "Cost and Wins Per Year", x = "Year", y = "Total Cost", color = "Wins")
cle
ggplot(data = cle, aes(x = (wins/(losses+wins)), y = total_cost)) + geom_point() + geom_smooth(method = "lm", color = "red", linetype = 2) + labs(title = "Cle Winning and Total Cost (AAV)", x = "Win Percentage", y = "Total Cost")
ggplot() + geom_point(data = cle, aes(x = (wins / (losses + wins)), y = total_cost)) + geom_smooth(method = "lm", color = "red", linetype = 2) + labs(title = "Cle Winning and Total Cost (AAV)", x = "Win Percentage", y = "Total Cost")
tysmean
ggplot() + geom_point(data = cle, aes(x = (wins / (losses + wins)), y = total_cost)) + geom_point(data = tys, aes(x = (wins / (losses + wins)), y = total_cost)) + labs(title = "Cle Winning and Total Cost (AAV)", x = "Win Percentage", y = "Total Cost")
ggplot() + geom_point(data = cle, aes(x = (wins / (losses + wins)), y = total_cost, colour="red")) + geom_point(data = tys, aes(x = (wins / (losses + wins)), y = total_cost)) + labs(title = "Cle Winning and Total Cost (AAV)", x = "Win Percentage", y = "Total Cost")
ggplot() + geom_point(data = cle, aes(x = (wins / (losses + wins)), y = total_cost, colour="red", size=3)) + geom_point(data = tys, aes(x = (wins / (losses + wins)), y = total_cost)) + labs(title = "Cle Winning and Total Cost (AAV)", x = "Win Percentage", y = "Total Cost")
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/WinningVersusSpending.R", encoding = "Windows-1252")
ggplot() + geom_point(data = cle, aes(x = (wins / (losses + wins)), y = total_cost, colour="orange", size=3)) + geom_point(data = tys, aes(x = (wins / (losses + wins)), y = total_cost)) + labs(title = "Cle Winning and Total Cost (AAV)", x = "Win Percentage", y = "Total Cost")
ggplot() + geom_point(data = cle, aes(x = (wins / (losses + wins)), y = total_cost, colour="orange", size=3)) + geom_point(data = tys, aes(x = (wins / (losses + wins)), y = total_cost)) + labs(title = "Cle Winning and Total Cost (AAV)", x = "Win Percentage", y = "Total Cost", size="Team"))
ggplot() + geom_point(data = cle, aes(x = (wins / (losses + wins)), y = total_cost, colour="orange", size=3)) + geom_point(data = tys, aes(x = (wins / (losses + wins)), y = total_cost)) + labs(title = "Cle Winning and Total Cost (AAV)", x = "Win Percentage", y = "Total Cost", size="Team")
ggplot() + geom_point(data = cle, aes(x = (wins / (losses + wins)), y = total_cost, colour="orange", size=3)) + geom_point(data = tys, aes(x = (wins / (losses + wins)), y = total_cost)) + labs(title = "Cle Winning and Total Cost (AAV)", x = "Win Percentage", y = "Total Cost", colour="Cleveland")
ne = tys[tys$team_id == "NE",]
ne
ggplot() + geom_point(data = cle, aes(x = (wins / (losses + wins)), y = total_cost, colour = "orange", size = 6)) + geom_point(data = ne, aes(x = (wins / (losses + wins)), y = total_cost, colour = "blue", size = 4)) + geom_point(data = tys, aes(x = (wins / (losses + wins)), y = total_cost)) + labs(title = "CLE/NE Winning and Total Cost (AAV)", x = "Win Percentage", y = "Total Cost", colour="NE,CLE", size="NE,CLE")
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/WinningVersusSpending.R", encoding = "Windows-1252")
ggplot() + geom_point(data = cle, aes(x = wins, y = total_cost, colour = "orange", size = 6)) + geom_point(data = ne, aes(x = wins, y = total_cost, colour = "blue", size = 4)) + geom_point(data = tys, aes(x = wins, y = total_cost)) + labs(title = "CLE/NE Winning and Total Cost (AAV)", x = "Win Percentage", y = "Total Cost", colour="NE,CLE", size="NE,CLE")
sum(cle)
summarize(cle)
summary(cle)
colSums(cle)
aggregate(cle,list(team_id), sum)
aggregate(cle,list("team_id"), sum)
aggregate(cle,list(Team = cle.team_id), sum)
aggregate(cle,list(Team = cle$team_id), sum)
str(cle)
aggregate(cle,list(Team = cle$team_id), mean)
aggregate(cle,list(Team = cle$team_id), sum)
aggregate(cle,list(Team = cle$team_id), mean)
aggregate(tys,list(Team = tys$team_id), mean)
aggregate(tys,list(Team = tys$team_id), mean)
groupby(tys,team_id)
library(dplyr)
groupby(tys,team_id)
group_by(tys,team_id)
select(tys,~id)
select(tys,~1)
select(tys,~"id")
select(tys,"id")
select(tys,-"id")
select(tys,-id)
tys <- select(tys, - id) tysg <- group_by(tys, team_id) tysgmean = aggregate(tysg, list(Team = tys$team_id), mean)
tysgmean
tysgmean = aggregate(tysg, list(Team = tys$team_id), mean) tysgmean <- select(tysgmean, - id)
tysgmean <- select(tysgmean, - team_id)
tysgmean
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + labs(title = "2011-2015 Winning and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm", color = "red", linetype = 2) + labs(title = "2011-2015 Mean Wins Per Season and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm", color = "red", linetype = 2) + labs(title = "2011-2015 Mean Wins Per Season and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "glm", color = "blue", linetype = 2) + labs(title = "2011-2015 Mean Wins Per Season and Total Cost (AAV)", x = "Wins", y = "Total Cost") ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm", color = "red", linetype = 2) + labs(title = "2011-2015 Mean Wins Per Season and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "glm", colour = "blue", linetype = 2) + labs(title = "2011-2015 Mean Wins Per Season and Total Cost (AAV)", x = "Wins", y = "Total Cost")
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/WinningVersusSpending.R", encoding = "Windows-1252")
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "glm", colour = "blue", linetype = 2) + labs(title = "2011-2015 Mean Wins Per Season and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm") + labs(title = "2011-2015 Mean Wins Per Season and Total Cost (AAV)", x = "Wins", y = "Total Cost")
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/WinningVersusSpending.R", encoding = "Windows-1252")
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm") + labs(title = "2011-2015 Mean Wins Per Season and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm") + geom_point(data = cle, aes(x = wins, y = total_cost, colour = "orange", size = 6)) + geom_point(data = ne, aes(x = wins, y = total_cost, colour = "blue", size = 6)) + labs(title = "2011-2015 Mean Wins Per Season and Total Cost (AAV)", x = "Wins", y = "Total Cost")
cle = tys[tysgmean$team_id == "CLE",] ne = tys[tysgmean$team_id == "NE",]
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm") + geom_point(data = cle, aes(x = wins, y = total_cost, colour = "orange", size = 6)) + geom_point(data = ne, aes(x = wins, y = total_cost, colour = "blue", size = 6)) + labs(title = "2011-2015 Mean Wins Per Season and Total Cost (AAV)", x = "Wins", y = "Total Cost")
cle
cle = tys[tysgmean$team == "CLE",] ne = tys[tysgmean$team == "NE",]
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm") + geom_point(data = cle, aes(x = wins, y = total_cost, colour = "orange", size = 6)) + geom_point(data = ne, aes(x = wins, y = total_cost, colour = "blue", size = 6)) + labs(title = "2011-2015 Mean Wins Per Season and Total Cost (AAV)", x = "Wins", y = "Total Cost")
cle
cle = tysgmean[tysgmean$team == "CLE",] ne = tysgmean[tysgmean$team == "NE",]
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm") + geom_point(data = cle, aes(x = wins, y = total_cost, colour = "orange", size = 6)) + geom_point(data = ne, aes(x = wins, y = total_cost, colour = "blue", size = 6)) + labs(title = "2011-2015 Mean Wins Per Season and Total Cost (AAV)", x = "Wins", y = "Total Cost")
tysmean
tysgmean
cle = tysgmean[tysgmean$team == "CLE",] ne = tysgmean[tysgmean$team == "NE",]
cle
cle = tysgmean[tysgmean$Team == "CLE",] ne = tysgmean[tysgmean$Team == "NE",]
cle
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm") + geom_point(data = cle, aes(x = wins, y = total_cost, colour = "orange", size = 6)) + geom_point(data = ne, aes(x = wins, y = total_cost, colour = "blue", size = 6)) + labs(title = "2011-2015 Mean Wins Per Season and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ne
ne = tysgmean[tysgmean$Team == "NE",]
ne
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/WinningVersusSpending.R", encoding = "Windows-1252")
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm") + geom_point(data = cle, aes(x = wins, y = total_cost, colour = "orange", size = 6)) + geom_point(data = ne, aes(x = wins, y = total_cost, colour = "blue", size = 6)) + labs(title = "2011-2015 Mean Wins Per Season and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm") + geom_point(data = cle, aes(x = wins, y = total_cost, colour = "orange", size = 6)) + geom_point(data = ne, aes(x = wins, y = total_cost, colour = "blue", size = 6)) + labs(title = "2011-2015 Mean Wins Per Season and Total Cost (AAV)", x = "Wins", y = "Total Cost")
cle, ne
cle
ne
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm") + geom_point(data = ne, aes(x = wins, y = total_cost, colour = "blue", size = 6)) + geom_point(data = cle, aes(x = wins, y = total_cost, colour = "orange", size = 6)) + labs(title = "2011-2015 Mean Wins Per Season and Total Cost (AAV)", x = "Wins", y = "Total Cost")
cle = tysgmean[tysgmean$Team %in% c("CLE","NE")]
cle = tysgmean[tysgmean$Team == "CLE" | tysgmean$Team == "NE",]
cle
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/WinningVersusSpending.R", encoding = "Windows-1252")
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm") + geom_point(data = special, aes(x = wins, y = total_cost, colour = "red", size = 6)) + labs(title = "2011-2015 Mean Wins Per Season and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm") + geom_point(data = special, aes(x = wins, y = total_cost, colour = "red", size = 6)) + labs(title = "2011-2015 Mean Wins Per Season and Total Cost (AAV)", x = "Wins", y = "Total Cost", colour = "NE,CLE", size = "NE,CLE")
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm") + geom_point(data = special, aes(x = wins, y = total_cost,  size = 6)) + labs(title = "2011-2015 Mean Wins Per Season and Total Cost (AAV)", x = "Wins", y = "Total Cost",  size = "NE,CLE")
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm") + geom_point(data = special, aes(x = wins, y = total_cost,  size = 6)) + labs(title = "2011-2015 Mean Wins and Total Cost (AAV)", x = "Wins", y = "Total Cost",  size = "NE,CLE")
source("~/Visual Studio 2015/Projects/DAHConsulting/NLFDashboard/NFLDashboard/NFLRANalysis/WinningVersusSpending.R", encoding = "Windows-1252")
ggplot(data = tys, aes(x = season_year, y = total_cost, color = wins)) + scale_colour_gradient(low = "red", high = "green") + geom_point() + geom_smooth(method = "lm", color = "green", linetype = 2) + labs(title = "Cost and Wins Per Year", x = "Year", y = "Total Cost", color = "Wins")
tysgmean
ggplot(data = tysgmean, aes(x = Team, y = total_cost, color = wins)) + scale_colour_gradient(low = "red", high = "green") + geom_bar() + labs(title = "Cost and Wins Per Year", x = "Team", y = "Total Cost", color = "Wins")
ggplot(data = tysgmean, aes( y = total_cost, color = wins)) + scale_colour_gradient(low = "red", high = "green") + geom_bar() + labs(title = "Cost and Wins Per Year", x = "Team", y = "Total Cost", color = "Wins")
ggplot(data = tysgmean, aes( x = total_cost, color = wins)) + scale_colour_gradient(low = "red", high = "green") + geom_bar(position = "stack") + labs(title = "Cost and Wins Per Year", x = "Team", y = "Total Cost", color = "Wins")
ggplot(data = tysgmean, aes( x = total_cost, fill = wins)) + #scale_colour_gradient(low = "red", high = "green") + geom_bar(position = "stack") + labs(title = "Cost and Wins Per Year", x = "Team", y = "Total Cost", color = "Wins")
ggplot(data = tysgmean, aes( y = total_cost, tfill = wins)) + #scale_colour_gradient(low = "red", high = "green") + geom_bar(position = "stack") + labs(title = "Cost and Wins Per Year", x = "Team", y = "Total Cost", color = "Wins")
ggplot(data = tysgmean, aes( x = wins, y = total_cost, fill = Team)) + #scale_colour_gradient(low = "red", high = "green") + geom_bar(position = "stack") + labs(title = "Cost and Wins Per Year", x = "Team", y = "Total Cost", color = "Wins")
ggplot(data = tysgmean, aes( x = wins, y = total_cost)) + #scale_colour_gradient(low = "red", high = "green") + geom_bar(stat=Team) + labs(title = "Cost and Wins Per Year", x = "Team", y = "Total Cost", color = "Wins")
ggplot(data = tysgmean, aes( x = wins, y = total_cost)) + #scale_colour_gradient(low = "red", high = "green") + geom_bar() + labs(title = "Cost and Wins Per Year", x = "Team", y = "Total Cost", color = "Wins")
ggplot(data = tysgmean, aes( x = wins, y = total_cost)) + #scale_colour_gradient(low = "red", high = "green") + geom_bar(stat = wins) + labs(title = "Cost and Wins Per Year", x = "Team", y = "Total Cost", color = "Wins")
ggplot(data = tysgmean, aes( x = wins, y = total_cost)) + #scale_colour_gradient(low = "red", high = "green") + geom_bar(stat = "wins") + labs(title = "Cost and Wins Per Year", x = "Team", y = "Total Cost", color = "Wins")
ggplot(data = tysgmean, aes( x = wins, y = total_cost)) + #scale_colour_gradient(low = "red", high = "green") + geom_bar()
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm") + #geom_point(data = special, aes(x = wins, y = total_cost,  size = 6)) + geom_text(aes(label=Team),size=3) labs(title = "2011-2015 Mean Wins and Total Cost (AAV)", x = "Wins", y = "Total Cost", size = "NE,CLE")
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm") + #geom_point(data = special, aes(x = wins, y = total_cost,  size = 6)) + geom_text(aes(label=tysgmean$Team),size=3) labs(title = "2011-2015 Mean Wins and Total Cost (AAV)", x = "Wins", y = "Total Cost", size = "NE,CLE")
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm") + #geom_point(data = special, aes(x = wins, y = total_cost,  size = 6)) + geom_text(aes(label=tysgmean$Team),size=3) + labs(title = "2011-2015 Mean Wins and Total Cost (AAV)", x = "Wins", y = "Total Cost", size = "NE,CLE" ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_smooth(method = "lm") + #geom_point(data = special, aes(x = wins, y = total_cost,  size = 6)) + geom_text(aes(label=tysgmean$Team),size=3) + labs(title = "2011-2015 Mean Wins and Total Cost (AAV)", x = "Wins", y = "Total Cost", size = "NE,CLE"
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + #geom_point(data = special, aes(x = wins, y = total_cost,  size = 6)) + geom_text(aes(label=tysgmean$Team),size=3) + labs(title = "2011-2015 Mean Wins and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_text(aes(label=tysgmean$Team),size=3)
ggplot() + geom_point(data = tysgmean, aes(x = wins, y = total_cost)) + geom_text(aes(label=tysgmean$Team),size=3) + labs(title = "2011-2015 Mean Wins and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot() + geom_point(data = tysgmean, aes(x = tysgmean$wins, y = tysgmean$total_cost)) + geom_text(aes(label=tysgmean$Team),size=3) + labs(title = "2011-2015 Mean Wins and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot(data = tysgmean, aes(x = tysgmean$wins, y = tysgmean$total_cost)) + geom_point() + geom_text(aes(label=tysgmean$Team),size=3) + labs(title = "2011-2015 Mean Wins and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot(data = tysgmean, aes(x = tysgmean$wins, y = tysgmean$total_cost)) + geom_point(aes(color = tysgmean$total_cost)) + geom_text(aes(label=tysgmean$Team),size=3) + labs(title = "2011-2015 Mean Wins and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot(data = tysgmean, aes(x = tysgmean$wins, y = tysgmean$total_cost)) + geom_point(aes(color = tysgmean$total_cost, size=8)) + geom_text(aes(label=tysgmean$Team),size=3) + labs(title = "2011-2015 Mean Wins and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot(data = tysgmean, aes(x = tysgmean$wins, y = tysgmean$total_cost)) + geom_point(aes(color = tysgmean$total_cost, size=8)) + geom_text(aes(label=tysgmean$Team),size=3, colour = "red") + labs(title = "2011-2015 Mean Wins and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot(data = tysgmean, aes(x = tysgmean$wins, y = tysgmean$total_cost)) + geom_point(aes(color = tysgmean$total_cost)) + geom_text(aes(label=tysgmean$Team),size=6, colour = "red") + labs(title = "2011-2015 Mean Wins and Total Cost (AAV)", x = "Wins", y = "Total Cost")
ggplot(data = tysgmean, aes(x = tysgmean$wins, y = tysgmean$total_cost)) + geom_point() + geom_text(aes(label=tysgmean$Team),size=6, colour = "red") + labs(title = "2011-2015 Mean Wins and Total Cost (AAV)", x = "Wins", y = "Total Cost")
tysgmean
tysgmean[order(wins)]
tysgmean[order(Wins)]
tysgmean[order(wins)]
tysgmean[order(tysgmena$wins)]
tysgmean
tysgmean[order(tysgmena$wins),]
tysgmean[order(wins),]
tysgmean[order(tysgmean$wins),]
x = mutate(tysgmean,fratio = offense_cost /total_cost)
x
x[order(x$wins),]
x[order(x$total_cost),]
summarize(tys)
summary(tys)
summarize(tys,sd(wins))
summarize(tysg,sd(wins))
tys_sd = summarize(tysg,sd(wins))
tys_sd
head(tsy_sd)
head(tys_sd,32)
tail(tys_sd,32)
tail(tys_sd)
tys_sd <- tys_sd[order(tys_sd$sd(wins)),]
tys_sd <- tys_sd[order(tys_sd$sd(wins))]
tys_sd <- tys_sd[order("sd(wins)"),]
tys
tys_sd
tys_sd = summarize(tysg,sd(wins))
tys_sd
tys_sd
colname(tys_sd) <- c("Team", "SD") 
colnames(tys_sd) <- c("Team", "SD") 
tys_sd <- tys_sd[order(tys_sd$SD),]
tys_sd
tail(tys_sd)
mutate(tysgmean,CPW = total_Cost/wins)
mutate(tysgmean,CPW = total_cost/wins)
tysgmean <- mutate(tysgmean,CPW = total_cost/wins)
tysgmean
tysgmean <- tysgmean[order(tysgmean$CPW),]
tysgmean
tysgmean <- mutate(tysgmean,CPW = total_cost/(wins+losses))
tysgmean <- tysgmean[order(tysgmean$CPW),]
tysgmean
ggplot(tysgmean, aes(x = total_cost, y = wins+losses, label = Team)) +     geom_point(aes(size = wins, colour = "blue")) +     geom_text(hjust = 1, size = 2) +     scale_size(range = c(1, 15)) +     theme_bw()
ggplot(tysgmean, aes(x = total_cost, y = (wins + losses)-16, label = Team)) +     geom_point(aes(size = wins, colour = "blue")) +     geom_text(hjust = 1, size = 2) +     scale_size(range = c(1, 15)) +     labs(title = "Mean Costs, Wins, Games 2011-2015", x = "Mean Cost in AAV", y = "Post Season Games")     theme_bw()
ggplot(tysgmean, aes(x = total_cost/1000000, y = (wins + losses)-16, label = Team)) +     geom_point(aes(size = wins, colour = "blue")) +     geom_text(hjust = 1, size = 2) +     scale_size(range = c(1, 15)) +     labs(title = "Mean Cost, Wins, Post Season Games 2011-2015", x = "Mean Cost (Millions) in AAV", y = "Post Season Games")     theme_bw()
ggplot(tysgmean, aes(x = total_cost/1000000, y = (wins + losses)-16, label = Team)) +     geom_point(aes(size = wins, colour = "blue")) +     geom_text(hjust = 1, size = 2) +     scale_size(range = c(1, 15)) +     labs(title = "Mean Cost, Wins, Post Season Games 2011-2015", x = "Mean Cost (Millions) in AAV", y = "Post Season Games") +     theme_bw()
ggplot(tysgmean, aes(x = total_cost/1000000, y = (wins + losses)-16, label = Team)) +     geom_point(aes(size = wins)) +     geom_text(hjust = 1, size = 2) +     scale_size(range = c(1, 15)) +     labs(title = "Mean Cost, Wins, Post Season Games 2011-2015", x = "Mean Cost (Millions) in AAV", y = "Post Season Games") +     theme_bw()
ggplot(tysgmean, aes(x = total_cost/1000000, y = (wins + losses)-16, label = Team)) +     geom_point(aes(size = wins)) +     geom_text(hjust = 1, size = 2, color="white") +     scale_size(range = c(1, 15)) +     labs(title = "Mean Cost, Wins, Post Season Games 2011-2015", x = "Mean Cost (Millions) in AAV", y = "Post Season Games") +     theme_bw()
ggplot(tysgmean, aes(x = total_cost/1000000, y = (wins + losses)-16, label = Team)) +     geom_point(aes(size = wins)) +     geom_text(hjust = 1, size = 2, color="blue") +     scale_size(range = c(1, 15)) +     labs(title = "Mean Cost, Wins, Post Season Games 2011-2015", x = "Mean Cost (Millions) in AAV", y = "Post Season Games") +     theme_bw()
ggplot(tysgmean, aes(x = total_cost/1000000, y = (wins + losses)-16, label = Team)) +     geom_point(aes(size = wins), shape=1) +     geom_text(hjust = 1, size = 2, color="blue") +     scale_size(range = c(1, 15)) +     labs(title = "Mean Cost, Wins, Post Season Games 2011-2015", x = "Mean Cost (Millions) in AAV", y = "Post Season Games") +     theme_bw()
ggplot(tysgmean, aes(x = total_cost/1000000, y = (wins + losses)-16, label = Team)) +     geom_point(aes(size = wins), shape=1) +     geom_text(hjust = 2, size = 2, color="black") +     scale_size(range = c(1, 15)) +     labs(title = "Cost, Wins, Post Season Games 2011-2015", x = "Avg Yearly Cost (AAV in Millions)", y = "Avg Post Season Games") +     theme_bw()
